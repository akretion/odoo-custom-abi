<?xml version="1.0" encoding="utf-8"?>
<template>

    <t t-name="LoadOrderLine" t-extend="LoadOrderLine">
        <t t-jquery="td:first" t-operation="replace">
            <td><t t-esc="order.name"/></td>
        </t>
    </t>

    <t t-name="OrderlineWithSubproducts" t-extend="Orderline">
        <t t-jquery="span.product-name" t-operation="append">
            <button>Configure</button>
        </t>
        <t t-jquery="ul.info-list" t-operation="append">
            <t t-foreach="line.get_product().subproducts" t-as="subproduct">
                <li class="info subproduct">
                    <t t-esc="subproduct_value.subproduct_display_name"/>
                    <t t-esc="widget.format_currency(subproduct_value.subproduct_price)"/>
                </li>
            </t>
        </t>
    </t>

    <t t-name="SelectSubproductPopupWidget">
        <div class="modal-dialog">
            <div class="popup popup-select-subproduct">
                <div class="select-area">
                    <p class="message"><t t-esc="widget.product.display_name"/></p>
                    <ul class="select-subproduct">
                        <li class="styled-select slate element">
                            <select class="select-subproduct">
                                <option value="choice">Select...</option>
                                <t t-foreach="widget.subproducts" t-as="subproduct">
                                    <option t-att-value="subproduct_value.id"><t t-esc="subproduct_value.subproduct_display_name"/>
                                        <t t-esc="widget.format_currency(subproduct_value.subproduct_price)"/>
                                    </option>
                                </t>
                            </select>
                        </li>
                        <li class="element">
                            <button class="delete-subproduct"><i class="fa fa-times"/></button>
                        </li>
                    </ul>
                </div>
                <div class="footer" style="height=20%">
                    <div class="button ok">
                        Add
                    </div>
                    <div class="button cancel">
                        Cancel
                    </div>
                </div>
            </div>
        </div>
    </t>

    <t t-name="Product" t-extend="Product">
        <t t-jquery="span.product" t-operation="replace">
            <span class="product" t-att-data-product-id="product.id" t-att-data-product-tmpl="product.product_tmpl_id">
                <div class="product-img">
                    <img t-att-src="image_url" />
                    <t t-if="!product.to_weight">
                        <span class="price-tag">
                            <t t-esc="widget.format_currency(product.price,'Product Price')"/>
                        </span>
                    </t>
                    <t t-if="product.to_weight">
                        <span class="price-tag">
                            <t t-esc="widget.format_currency(product.price,'Product Price')+'/Kg'"/>
                        </span>
                    </t>
                </div>
                <div class="product-name">
                    <t t-esc="product.display_name"/>
                </div>
            </span>
        </t>
    </t>
    <t t-name="XmlReceipt" t-extend="XmlReceipt">
        <t t-jquery="line:has(t[t-esc='line.product_name'])" t-operation="after">
            <t t-if="line.subproducts">
                <t t-foreach="line.subproducts" t-as="subproduct">
                    <line indent="1">
                        <left>
                            <t t-esc="subproduct_value.subproduct_display_name"/>
                            <value><t t-esc="subproduct_value.subproduct_price"/></value>
                        </left>
                    </line>
                </t>
            </t>
        </t>
        <t t-jquery="receipt" t-operation="append">
            <t t-set="index" t-value="0"/>
            <t t-foreach="receipt.orderlines" t-as="line">
                <t t-if="line.subproducts">
                    <t t-set="index" t-value="index+1"/>
                    <cut/>
                    <div>
                        <p>Manufacturing order nÂ°</p>
                        <p><t t-esc="line.lot_number"/></p>
                        <br/>
                        <barcode encoding="ean13"><t t-esc="line.ean13"/></barcode>
                        <br/>
                        <p>
                            <left><t t-esc="line.product_name"/> X
                                <value value-decimals="3" value-autoint="on">
                                    <t t-esc="line.quantity"/>
                                </value>
                            </left>
                        </p>
                        <t t-foreach="line.subproducts" t-as="subproduct">
                            <p>
                                <left indent="1">
                                    <t t-esc="subproduct_value.subproduct_display_name"/>
                                </left>
                            </p>
                        </t>
                    </div>
                </t>
            </t>
        </t>
    </t>

</template>
